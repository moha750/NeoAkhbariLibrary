# ๐ง ุฅุตูุงุญ ุฎุทุฃ 406: Not Acceptable

## โ ุงููุดููุฉ

ุนูุฏ ูุชุญ ุฑุงุจุท ุงูุฏุนูุฉ ูู `signup.html`:

```
Failed to load resource: 406 (Not Acceptable)
ุฎุทุฃ ูู ุงูุชุญูู ูู ุงูุฏุนูุฉ
```

---

## ๐ฏ ุงูุณุจุจ

**RLS Policy** ุงูุญุงููุฉ ุชุณูุญ **ููุท ููุฅุฏุงุฑููู** ุจูุฑุงุกุฉ ุงูุฏุนูุงุช:

```sql
-- โ ุงูุณูุงุณุฉ ุงููุฏููุฉ
CREATE POLICY "Admins can manage invitations" ON invitations
    FOR ALL USING (is_admin());
```

**ุงููุดููุฉ:**
- ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ (ุบูุฑ ูุณุฌู) ูุญุงูู ูุฑุงุกุฉ ุงูุฏุนูุฉ ููุชุญูู ูููุง
- ููู RLS ุชุฑูุถ ูุฃูู ููุณ ุฅุฏุงุฑู!

---

## โ ุงูุญู

ุฅุถุงูุฉ ุณูุงุณุฉ ููุณูุงุญ **ููุฌููุน** ุจูุฑุงุกุฉ ุงูุฏุนูุงุช **ุงููุนููุฉ ููุท**:

```sql
-- โ ุงูุณูุงุณุฉ ุงูุฌุฏูุฏุฉ
CREATE POLICY "Anyone can view pending invitations" ON invitations
    FOR SELECT USING (status = 'pending');
```

**ุงูุฃูุงู:**
- โ ูููู ูุฑุงุกุฉ ุงูุฏุนูุงุช ุงููุนููุฉ ููุท (status = 'pending')
- โ ูุง ูููู ูุฑุงุกุฉ ุงูุฏุนูุงุช ุงูููุจููุฉ ุฃู ุงูููุชููุฉ
- โ ุงูุฅุฏุงุฑููู ููุท ูููููู ุฅูุดุงุก/ุชุญุฏูุซ/ุญุฐู ุงูุฏุนูุงุช

---

## ๐ ุฎุทูุงุช ุงูุชุทุจูู

### ุงูุทุฑููุฉ 1: SQL Editor (ุณุฑูุนุฉ)

```
1. ุงูุชุญ Supabase Dashboard
2. ุงุฐูุจ ุฅูู: SQL Editor
3. ุงูุณุฎ ูุญุชูู ููู fix-invitation-rls.sql
4. ุงูุตูู ูููุฐู (Run)
```

### ุงูุทุฑููุฉ 2: ุฅุนุงุฏุฉ ุชูููุฐ database.sql

```
1. ุงูุชุญ Supabase Dashboard
2. ุงุฐูุจ ุฅูู: SQL Editor
3. ุงูุณุฎ ูุญุชูู database.sql (ุงูููุญุฏุซ)
4. ุงูุตูู ูููุฐู (Run)
```

---

## โ ุงูุชุญูู ูู ุงูุฅุตูุงุญ

### 1. ุชุญูู ูู ุงูุณูุงุณุงุช

ูู Supabase SQL Editor:

```sql
SELECT 
    policyname,
    cmd,
    qual
FROM pg_policies 
WHERE tablename = 'invitations';
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**

| policyname | cmd | qual |
|------------|-----|------|
| Anyone can view pending invitations | SELECT | (status = 'pending') |
| Admins can manage invitations | ALL | (is_admin()) |

---

### 2. ุงุฎุชุจุฑ ุฑุงุจุท ุงูุฏุนูุฉ

```
1. ุฃุฑุณู ุฏุนูุฉ ุฌุฏูุฏุฉ ูู dashboard.html
2. ุงูุณุฎ ุงูุฑุงุจุท
3. ุงูุชุญู ูู ูุงูุฐุฉ Incognito/Private
4. ูุฌุจ ุฃู ุชุธูุฑ ุตูุญุฉ signup.html ุจุฏูู ุฃุฎุทุงุก
```

---

## ๐ ูุง ูุญุฏุซ ุงูุขู

### ูุจู ุงูุฅุตูุงุญ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ุงููุณุชุฎุฏู ููุชุญ ุฑุงุจุท ุงูุฏุนูุฉ          โ
โ     signup.html?token=inv_xxxxx        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. JavaScript ูุญุงูู ูุฑุงุกุฉ ุงูุฏุนูุฉ      โ
โ     SELECT * FROM invitations           โ
โ     WHERE token = 'inv_xxxxx'          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. RLS Policy ุชุชุญูู                    โ
โ     ูู ุงููุณุชุฎุฏู ุฅุฏุงุฑูุ                 โ
โ     โ ูุง โ ุฑูุถ ุงูุทูุจ (406)             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ุจุนุฏ ุงูุฅุตูุงุญ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ุงููุณุชุฎุฏู ููุชุญ ุฑุงุจุท ุงูุฏุนูุฉ          โ
โ     signup.html?token=inv_xxxxx        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. JavaScript ูุญุงูู ูุฑุงุกุฉ ุงูุฏุนูุฉ      โ
โ     SELECT * FROM invitations           โ
โ     WHERE token = 'inv_xxxxx'          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. RLS Policy ุชุชุญูู                    โ
โ     ูู status = 'pending'ุ             โ
โ     โ ูุนู โ ุงูุณูุงุญ ุจุงููุฑุงุกุฉ            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ุงูุฃูุงู

### ุงูุณูุงุณุงุช ุงูุญุงููุฉ:

```sql
-- 1. ูุฑุงุกุฉ ุงูุฏุนูุงุช ุงููุนููุฉ (ููุฌููุน)
CREATE POLICY "Anyone can view pending invitations" ON invitations
    FOR SELECT USING (status = 'pending');

-- 2. ุฅุฏุงุฑุฉ ุงูุฏุนูุงุช (ููุฅุฏุงุฑููู ููุท)
CREATE POLICY "Admins can manage invitations" ON invitations
    FOR ALL USING (is_admin());
```

### ูุง ูููู ูุนูู:

| ุงููุณุชุฎุฏู | ูุฑุงุกุฉ pending | ูุฑุงุกุฉ accepted | ุฅูุดุงุก | ุชุญุฏูุซ | ุญุฐู |
|----------|---------------|----------------|-------|-------|-----|
| ุบูุฑ ูุณุฌู | โ | โ | โ | โ | โ |
| ูุณุฌู (ุนุงุฏู) | โ | โ | โ | โ | โ |
| ุฅุฏุงุฑู | โ | โ | โ | โ | โ |

---

## ๐ ุฅุฐุง ูู ูุนูู

### ุชุญูู ูู RLS

```sql
-- ุชุฃูุฏ ูู ุฃู RLS ููุนู
SELECT tablename, rowsecurity 
FROM pg_tables 
WHERE tablename = 'invitations';

-- ูุฌุจ ุฃู ูููู rowsecurity = true
```

### ุชุญูู ูู ุงูุณูุงุณุงุช

```sql
-- ุนุฑุถ ุฌููุน ุงูุณูุงุณุงุช
SELECT * FROM pg_policies 
WHERE tablename = 'invitations';
```

### ุฃุนุฏ ุฅูุดุงุก ุงูุณูุงุณุงุช

```sql
-- ุงุญุฐู ุฌููุน ุงูุณูุงุณุงุช
DROP POLICY IF EXISTS "Anyone can view pending invitations" ON invitations;
DROP POLICY IF EXISTS "Admins can manage invitations" ON invitations;

-- ุฃุนุฏ ุฅูุดุงุฆูุง
-- (ุงูุณุฎ ูู fix-invitation-rls.sql)
```

---

## ๐ ุงูููุงุฑูุฉ

| ุงูุญุงูุฉ | ูุจู | ุจุนุฏ |
|--------|-----|-----|
| ูุฑุงุกุฉ ุงูุฏุนูุฉ ูู signup.html | โ 406 | โ 200 |
| ุงูุฃูุงู | โ | โ |
| ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู | โ | โ |

---

## ๐ฏ ุงูุฎูุงุตุฉ

### ูุง ุชู ุฅุตูุงุญู:

```
โ ุงูุณูุงุญ ุจูุฑุงุกุฉ ุงูุฏุนูุงุช ุงููุนููุฉ ููุฌููุน
โ ุงูุญูุงุธ ุนูู ุงูุฃูุงู (pending ููุท)
โ ุงูุฅุฏุงุฑููู ููุท ูููููู ุฅุฏุงุฑุฉ ุงูุฏุนูุงุช
โ signup.html ูุนูู ุจุฏูู ุฃุฎุทุงุก
```

### ูุง ูุฌุจ ูุนูู:

```
1. ููุฐ fix-invitation-rls.sql ูู Supabase SQL Editor
2. ุฌุฑุจ ูุชุญ ุฑุงุจุท ุฏุนูุฉ ุฌุฏูุฏ
3. ูุฌุจ ุฃู ูุนูู ุจุฏูู ุฃุฎุทุงุก!
```

---

**ุชู ุงูุฅุตูุงุญ! ๐**

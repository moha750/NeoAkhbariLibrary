# โ ุงูุฅุนุฏุงุฏ ุงูููุงุฆู - ูุธุงู ุงูุฏุนูุงุช

## ๐ฏ ุงููุถุน ุงูููุงุฆู

### ูุง ุชู ุชุทุจููู:

```
โ ูุธุงู ุฏุนูุงุช ูุงูู
โ RLS Policies ูุญููุฉ
โ ุฅูุดุงุก ุงูุฏุนูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ ูุณุฎ ุงูุฑุงุจุท ุชููุงุฆูุงู
โ ุตูุญุฉ signup.html ุชุนูู
โ ูุจูู ุงูุฏุนูุฉ ูุฅูุดุงุก ุงููุณุชุฎุฏู
โ ุฑุจุท ุงูุฏุนูุฉ ุจุงููุณุชุฎุฏู
โ ุฑุณุงุฆู ูุงุถุญุฉ ูุตุงุฏูุฉ
```

---

## ๐ ุฎุทูุงุช ุงูุชุทุจูู ุงูููุงุฆูุฉ

### 1. ุชุทุจูู RLS Policies

ูู Supabase SQL Editor:

```sql
-- ููุฐ ูุญุชูู fix-invitation-rls.sql
-- ุฃู ููุฐ database.sql ูุงููุงู
```

**ุงููููุงุช:**
- `fix-invitation-rls.sql` - ุฅุตูุงุญ ุณูุงุณุงุช ุงูุฏุนูุงุช
- `database.sql` - ูุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

### 2. ุชูุธูู ุงููุณุชุฎุฏููู (ุฅุฐุง ูุฒู ุงูุฃูุฑ)

ูู Supabase SQL Editor:

```sql
-- ููุฐ ูุญุชูู clean-invited-users.sql
-- ูุญุฐู ุงููุณุชุฎุฏููู ุงูุฐูู ุชู ุฅูุดุงุคูู ุนุจุฑ inviteUserByEmail
```

**ุงูููู:** `clean-invited-users.sql`

---

### 3. ูุดุฑ Edge Function

ูู Terminal:

```bash
# ุชุณุฌูู ุงูุฏุฎูู (ุฅุฐุง ูู ุชูู ูุณุฌูุงู)
supabase login

# ุฑุจุท ุงููุดุฑูุน (ุฅุฐุง ูู ููู ูุฑุจูุทุงู)
supabase link --project-ref yfudytvojcusgemyager

# ูุดุฑ Edge Function
supabase functions deploy send-invitation
```

---

### 4. ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุงุช

```
Ctrl + F5 ูู:
- dashboard.html
- signup.html
```

---

## โ ุงุฎุชุจุงุฑ ุงููุธุงู

### 1. ุฅุฑุณุงู ุฏุนูุฉ

```
1. ุงูุชุญ dashboard.html
2. ุณุฌู ุฏุฎูู ูุฅุฏุงุฑู
3. ุชุจููุจ "ูุฑูู ุงูุนูู"
4. ุฃุฏุฎู ุจุฑูุฏ ุฅููุชุฑููู
5. ุงุฎุชุฑ ุฏูุฑ "ูุญุฑุฑ"
6. ุงุถุบุท "ุฅุฑุณุงู ุงูุฏุนูุฉ"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**

```
Alert:
โ ุชู ุฅูุดุงุก ุงูุฏุนูุฉ ุจูุฌุงุญ!

๐ ุชู ูุณุฎ ุฑุงุจุท ุงูุฏุนูุฉ. ุฃุฑุณูู ููุดุฎุต ุงููุฏุนู:

๐ง user@example.com

๐ http://127.0.0.1:5500/signup.html?token=inv_xxxxx

๐ก ููููู ุฅุฑุณุงูู ุนุจุฑ WhatsApp ุฃู Telegram ุฃู ุฃู ูุณููุฉ ุฃุฎุฑู
```

---

### 2. ูุจูู ุงูุฏุนูุฉ

```
1. ุงูุณุฎ ุงูุฑุงุจุท
2. ุงูุชุญู ูู ูุงูุฐุฉ Incognito/Private
3. ูุฌุจ ุฃู ุชุธูุฑ signup.html
4. ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุนุจุฃ ูุณุจูุงู
5. ุฃุฏุฎู ูููุฉ ูุฑูุฑ
6. ุงุถุบุท "ุฅูุดุงุก ุงูุญุณุงุจ"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**

```
โ ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ
โ ุชู ูุจูู ุงูุฏุนูุฉ
โ ุชุญููู ุฅูู dashboard.html
```

---

### 3. ุงูุชุญูู ูู ุงูุตูุงุญูุงุช

```
1. ูู dashboard.html
2. ุชุญูู ูู ุฃู ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ:
   - ููููู ุฑุคูุฉ ููุญุฉ ุงูุชุญูู
   - ูุฏูู ุงูุฏูุฑ ุงูุตุญูุญ (ูุญุฑุฑ)
   - ูุง ููููู ุงููุตูู ูููุฒุงุช ุงูุฅุฏุงุฑู
```

---

## ๐ ุงูููุฒุงุช ุงูููุงุฆูุฉ

| ุงูููุฒุฉ | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|--------|--------|-----------|
| ุฅูุดุงุก ุงูุฏุนูุฉ | โ | ูุนูู ุจุดูู ูุงูู |
| ูุณุฎ ุงูุฑุงุจุท ุชููุงุฆูุงู | โ | ูุนูู ุจุดูู ูุงูู |
| ุตูุญุฉ signup.html | โ | ูุนูู ุจุดูู ูุงูู |
| ูุจูู ุงูุฏุนูุฉ | โ | ูุนูู ุจุดูู ูุงูู |
| RLS Policies | โ | ูุญููุฉ ูุขููุฉ |
| ุงูุฑุณุงุฆู ุงููุงุถุญุฉ | โ | ุตุงุฏูุฉ ูุฏูููุฉ |
| ุฅุฑุณุงู ุจุฑูุฏ ุชููุงุฆู | โ๏ธ | ูุญุชุงุฌ ุฅุนุฏุงุฏ (ุงุฎุชูุงุฑู) |
| ุงูุฅุฑุณุงู ุงููุฏูู | โ | ูุนูู ุจุดูู ููุชุงุฒ |

---

## ๐ ุงูุฃูุงู

### RLS Policies ุงููุทุจูุฉ:

```sql
-- 1. ูุฑุงุกุฉ ุงูุฏุนูุงุช ุงููุนููุฉ (ููุฌููุน)
CREATE POLICY "Anyone can view pending invitations" ON invitations
    FOR SELECT USING (status = 'pending');

-- 2. ุฅุฏุงุฑุฉ ุงูุฏุนูุงุช (ููุฅุฏุงุฑููู ููุท)
CREATE POLICY "Admins can manage invitations" ON invitations
    FOR ALL USING (is_admin());

-- 3. ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ (ูููุณุชุฎุฏู ููุณู)
CREATE POLICY "Users can view their own data" ON users
    FOR SELECT USING (auth.uid() = id);

-- 4. ูุฑุงุกุฉ ุฌููุน ุงููุณุชุฎุฏููู (ููุฅุฏุงุฑููู)
CREATE POLICY "Admins can view all users" ON users
    FOR SELECT USING (is_admin());
```

---

## ๐ฏ ุณููุงุฑูู ุงูุงุณุชุฎุฏุงู ุงููุงูู

### ูู ุงูุจุฏุงูุฉ ููููุงูุฉ:

```
1. ุงูุฅุฏุงุฑู ูุณุฌู ุฏุฎูู ูู dashboard.html
   โ
2. ูุฐูุจ ูุชุจููุจ "ูุฑูู ุงูุนูู"
   โ
3. ูุฏุฎู ุจุฑูุฏ ุงููุฏุนู ููุฎุชุงุฑ ุงูุฏูุฑ
   โ
4. ูุถุบุท "ุฅุฑุณุงู ุงูุฏุนูุฉ"
   โ
5. โ ุงูุฏุนูุฉ ุชููุดุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   โ
6. โ ุงูุฑุงุจุท ูููุณุฎ ุชููุงุฆูุงู
   โ
7. ุงูุฅุฏุงุฑู ูุฑุณู ุงูุฑุงุจุท ุนุจุฑ WhatsApp/Telegram
   โ
8. ุงููุฏุนู ููุชุญ ุงูุฑุงุจุท
   โ
9. ูุธูุฑ signup.html ูุน ุงูุจุฑูุฏ ูุนุจุฃ ูุณุจูุงู
   โ
10. ุงููุฏุนู ูุฏุฎู ูููุฉ ุงููุฑูุฑ
   โ
11. ูุถุบุท "ุฅูุดุงุก ุงูุญุณุงุจ"
   โ
12. โ ุงููุณุชุฎุฏู ูููุดุฃ ูู auth.users
   โ
13. โ accept_invitation() ูุฑุจุท ุงูุฏุนูุฉ ุจุงููุณุชุฎุฏู
   โ
14. โ ุงูุณุฌู ูููุดุฃ ูู ุฌุฏูู users
   โ
15. โ ุชุญููู ุฅูู dashboard.html
   โ
16. โ ุงููุณุชุฎุฏู ููููู ุงููุตูู ุญุณุจ ุตูุงุญูุงุชู
```

---

## ๐ ุงููููุงุช ุงููููุฉ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช:
- `database.sql` - ูุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `fix-invitation-rls.sql` - ุฅุตูุงุญ RLS
- `clean-invited-users.sql` - ุชูุธูู ุงููุณุชุฎุฏููู

### ุงูููุฏ:
- `dashboard.html` - ููุญุฉ ุงูุชุญูู
- `signup.html` - ุตูุญุฉ ุงูุชุณุฌูู
- `supabase-api.js` - API wrapper
- `supabase/functions/send-invitation/index.ts` - Edge Function

### ุงูุชูุซูู:
- `SETUP_GUIDE.md` - ุฏููู ุงูุฅุนุฏุงุฏ ุงููุงูู
- `FIX_406_ERROR.md` - ุฅุตูุงุญ ุฎุทุฃ 406
- `FIX_409_FOREIGN_KEY.md` - ุฅุตูุงุญ ุฎุทุฃ 409
- `FIX_USER_ALREADY_REGISTERED.md` - ุฅุตูุงุญ "User already registered"
- `FINAL_SETUP.md` - ูุฐุง ุงูููู

---

## ๐ ุงูุฎูุงุตุฉ

### ูุง ุชู ุฅูุฌุงุฒู:

```
โ ูุธุงู ุฏุนูุงุช ูุงูู ููุญูู
โ RLS Policies ุขููุฉ
โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ
โ ุฑุณุงุฆู ูุงุถุญุฉ ูุตุงุฏูุฉ
โ ูุนูู ุจุฏูู ุฅุนุฏุงุฏ ุฅุถุงูู
โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู
```

### ุงููุถุน ุงูุญุงูู:

```
โ Development: ุฌุงูุฒ ููุนูู
โ Production: ุฌุงูุฒ (ุจุนุฏ ุชุบููุฑ ุงูุฑูุงุจุท)
โ๏ธ Email: ูุญุชุงุฌ ุฅุนุฏุงุฏ (ุงุฎุชูุงุฑู)
โ Manual: ูุนูู ุจุดูู ููุชุงุฒ
```

---

## ๐ ููุจุฏุก ุงูุขู

```bash
# 1. ููุฐ SQL
# ูู Supabase SQL Editor: fix-invitation-rls.sql

# 2. ูุดุฑ Edge Function
supabase functions deploy send-invitation

# 3. ุฃุนุฏ ุชุญููู ุงูุตูุญุงุช
# Ctrl + F5

# 4. ุฌุฑุจ ุฅุฑุณุงู ุฏุนูุฉ!
```

---

**ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**

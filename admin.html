<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .back-btn {
            display: inline-block;
            background: #764ba2;
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            text-decoration: none;
            margin-top: 15px;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: #667eea;
            transform: translateY(-2px);
        }

        .form-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            color: #333;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: border 0.3s;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        #contentInput {
            min-height: 400px;
            font-family: 'Courier New', monospace;
            line-height: 1.8;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        button {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .publish-btn {
            background: #667eea;
            color: white;
        }

        .publish-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .clear-btn {
            background: #e0e0e0;
            color: #333;
        }

        .clear-btn:hover {
            background: #d0d0d0;
        }

        .books-list {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .books-list h2 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }

        .book-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .book-item:hover {
            background: #e9ecef;
            transform: translateX(-5px);
        }

        .book-info {
            flex: 1;
        }

        .book-item-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .book-item-author {
            color: #667eea;
            margin-bottom: 5px;
        }

        .book-item-date {
            color: #999;
            font-size: 0.9em;
        }

        .book-actions {
            display: flex;
            gap: 10px;
        }

        .edit-btn,
        .delete-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .edit-btn {
            background: #667eea;
            color: white;
        }

        .edit-btn:hover {
            background: #764ba2;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .success-message {
            background: #28a745;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .no-books {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .char-count {
            text-align: left;
            color: #999;
            font-size: 0.9em;
            margin-top: 5px;
        }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
        .tabs-container {
            background: white;
            padding: 0;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .tabs-header {
            display: flex;
            background: #f8f9fa;
            border-bottom: 3px solid #e0e0e0;
        }

        .tab-btn {
            flex: 1;
            padding: 20px;
            background: transparent;
            border: none;
            font-size: 1.1em;
            font-weight: bold;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .tab-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .tab-btn.active {
            color: #667eea;
            background: white;
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: #667eea;
        }

        .tab-content {
            display: none;
            padding: 40px;
        }

        .tab-content.active {
            display: block;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
            margin-right: 10px;
        }

        .status-pending {
            background: #ffc107;
            color: #856404;
        }

        .status-verified {
            background: #28a745;
            color: white;
        }

        .verify-btn {
            background: #28a745;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .verify-btn:hover {
            background: #218838;
        }

        .preview-btn {
            background: #17a2b8;
            color: white;
        }

        .preview-btn:hover {
            background: #138496;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1em;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
            <p class="subtitle">Ù†Ø´Ø± ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØªØ¨</p>
            <a href="index.html" class="back-btn">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        </header>

        <div class="tabs-container">
            <div class="tabs-header">
                <button class="tab-btn active" onclick="switchTab('publish')">ğŸ“¤ Ø¥Ù†Ø´Ø§Ø¡ ÙƒØªØ§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
                <button class="tab-btn" onclick="switchTab('review')">ğŸ” Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚</button>
                <button class="tab-btn" onclick="switchTab('publish-stage')">ğŸš€ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù†Ø´Ø±</button>
                <button class="tab-btn" onclick="switchTab('published')">ğŸ“š Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©</button>
                <button class="tab-btn" onclick="switchTab('stats')">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ù†Ø´Ø± ÙƒØªØ§Ø¨ Ø¬Ø¯ÙŠØ¯ -->
            <div id="publishTab" class="tab-content active">
                <div class="success-message" id="successMessage">
                    âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¥Ø¶Ø§ÙØ© ØµÙØ­Ø§Øª Ù„Ù„ÙƒØªØ§Ø¨.
                </div>

                <form id="bookForm">
                <div class="form-group">
                    <label for="titleInput">ğŸ“– Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØªØ§Ø¨</label>
                    <input type="text" id="titleInput" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØªØ§Ø¨" required>
                </div>

                <div class="form-group">
                    <label for="authorInput">âœï¸ Ø§Ø³Ù… Ø§Ù„Ù…Ø¤Ù„Ù</label>
                    <input type="text" id="authorInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¤Ù„Ù" required>
                </div>

                <div class="form-group">
                    <label for="descriptionInput">ğŸ“ ÙˆØµÙ Ù…Ø®ØªØµØ±</label>
                    <textarea id="descriptionInput" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙØ§Ù‹ Ù…Ø®ØªØµØ±Ø§Ù‹ Ø¹Ù† Ø§Ù„ÙƒØªØ§Ø¨" required></textarea>
                    <div class="char-count" id="descCharCount">0 Ø­Ø±Ù</div>
                </div>

                <div style="background: #f0f8ff; padding: 20px; border-radius: 10px; border: 2px dashed #667eea; margin-bottom: 20px;">
                    <p style="color: #667eea; font-weight: bold; margin-bottom: 10px;">ğŸ“š Ù…Ù„Ø§Ø­Ø¸Ø©:</p>
                    <p style="color: #666;">Ø¨Ø¹Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨ØŒ Ø³ØªØªÙ…ÙƒÙ† Ù…Ù† Ø¥Ø¶Ø§ÙØ© ØµÙØ­Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„ÙƒØªØ§Ø¨ Ù…Ù† Ø®Ù„Ø§Ù„ ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØªØ§Ø¨.</p>
                </div>

                <input type="hidden" id="editingId" value="">

                    <div class="btn-group">
                        <button type="submit" class="publish-btn">ğŸ“¤ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨</button>
                        <button type="button" class="clear-btn" onclick="clearForm()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
                    </div>
                </form>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ -->
            <div id="reviewTab" class="tab-content">
                <h2 style="color: #667eea; margin-bottom: 20px; text-align: center;">ğŸ” Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚</h2>
                <p style="text-align: center; color: #666; margin-bottom: 30px;">Ø§Ù„ÙƒØªØ¨ Ø§Ù„ØªØ§Ù„ÙŠØ© ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ù…Ø­ØªÙˆÙ‰</p>
                <div id="reviewList">
                    <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒØªØ¨ Ù‚ÙŠØ¯ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù†Ø´Ø± -->
            <div id="publishStageTab" class="tab-content">
                <h2 style="color: #667eea; margin-bottom: 20px; text-align: center;">ğŸš€ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø´Ø±</h2>
                <p style="text-align: center; color: #666; margin-bottom: 30px;">Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ø¯Ù‚Ù‚Ø© ÙˆØ§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø´Ø± Ù„Ù„Ù‚Ø±Ø§Ø¡</p>
                <div id="publishStageList">
                    <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø´Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø© -->
            <div id="publishedTab" class="tab-content">
                <h2 style="color: #667eea; margin-bottom: 20px; text-align: center;">ğŸ“š Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ø¯Ù‚Ù‚Ø© ÙˆØ§Ù„Ù…Ù†Ø´ÙˆØ±Ø©</h2>
                <div id="publishedList">
                    <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø© Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            <div id="statsTab" class="tab-content">
                <h2 style="color: #667eea; margin-bottom: 30px; text-align: center;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙƒØªØ¨Ø©</h2>
                <div class="stats-grid" id="statsGrid">
                    <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‡Ù†Ø§ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø­Ø±Ù
        document.getElementById('descriptionInput').addEventListener('input', function() {
            document.getElementById('descCharCount').textContent = this.value.length + ' Ø­Ø±Ù';
        });

        // Ù†Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨
        document.getElementById('bookForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('titleInput').value.trim();
            const author = document.getElementById('authorInput').value.trim();
            const description = document.getElementById('descriptionInput').value.trim();
            const editingId = document.getElementById('editingId').value;
            
            if (!title || !author || !description) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }
            
            let books = JSON.parse(localStorage.getItem('books') || '[]');
            
            if (editingId) {
                // ØªØ­Ø¯ÙŠØ« ÙƒØªØ§Ø¨ Ù…ÙˆØ¬ÙˆØ¯
                const index = books.findIndex(b => b.id === editingId);
                if (index !== -1) {
                    books[index] = {
                        ...books[index],
                        title,
                        author,
                        description,
                        updatedDate: new Date().toLocaleDateString('ar-EG')
                    };
                }
            } else {
                // Ø¥Ø¶Ø§ÙØ© ÙƒØªØ§Ø¨ Ø¬Ø¯ÙŠØ¯
                const book = {
                    id: Date.now().toString(),
                    title,
                    author,
                    description,
                    pages: [],
                    date: new Date().toLocaleDateString('ar-EG'),
                    views: 0,
                    verified: false,
                    published: false,
                    verifiedDate: null,
                    publishedDate: null
                };
                books.unshift(book);
            }
            
            localStorage.setItem('books', JSON.stringify(books));
            
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
            const successMsg = document.getElementById('successMessage');
            successMsg.style.display = 'block';
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
            
            const newBookId = editingId || book.id;
            clearForm();
            loadAllTabs();
            
            if (!editingId) {
                // ÙØªØ­ ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØªØ§Ø¨
                window.location.href = `manage-book.html?id=${newBookId}`;
            }
        });

        // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
        function clearForm() {
            document.getElementById('bookForm').reset();
            document.getElementById('editingId').value = '';
            document.getElementById('descCharCount').textContent = '0 Ø­Ø±Ù';
            document.querySelector('.publish-btn').textContent = 'ğŸ“¤ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨';
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function switchTab(tabName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
            if (tabName === 'publish') {
                document.getElementById('publishTab').classList.add('active');
                document.querySelectorAll('.tab-btn')[0].classList.add('active');
            } else if (tabName === 'review') {
                document.getElementById('reviewTab').classList.add('active');
                document.querySelectorAll('.tab-btn')[1].classList.add('active');
                loadReviewBooks();
            } else if (tabName === 'publish-stage') {
                document.getElementById('publishStageTab').classList.add('active');
                document.querySelectorAll('.tab-btn')[2].classList.add('active');
                loadPublishStageBooks();
            } else if (tabName === 'published') {
                document.getElementById('publishedTab').classList.add('active');
                document.querySelectorAll('.tab-btn')[3].classList.add('active');
                loadPublishedBooks();
            } else if (tabName === 'stats') {
                document.getElementById('statsTab').classList.add('active');
                document.querySelectorAll('.tab-btn')[4].classList.add('active');
                loadStats();
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚
        function loadReviewBooks() {
            const books = JSON.parse(localStorage.getItem('books') || '[]');
            const reviewBooks = books.filter(book => !book.verified && !book.published);
            const reviewList = document.getElementById('reviewList');
            
            if (reviewBooks.length === 0) {
                reviewList.innerHTML = '<div class="no-books">âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒØªØ¨ ÙÙŠ Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚</div>';
                return;
            }
            
            reviewList.innerHTML = reviewBooks.map(book => `
                <div class="book-item">
                    <div class="book-info">
                        <div>
                            <span class="status-badge status-pending">Ù‚ÙŠØ¯ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚</span>
                            <span class="book-item-title">${book.title}</span>
                        </div>
                        <div class="book-item-author">âœï¸ ${book.author}</div>
                        <div class="book-item-date">ğŸ“… ${book.date} | ğŸ“„ ${book.pages ? book.pages.length : 0} ØµÙØ­Ø©</div>
                    </div>
                    <div class="book-actions">
                        <button class="edit-btn preview-btn" onclick="manageBook('${book.id}')">ğŸ“š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙØ­Ø§Øª</button>
                        <button class="verify-btn" onclick="verifyBook('${book.id}')">âœ… ØªØ¯Ù‚ÙŠÙ‚</button>
                        <button class="edit-btn" onclick="editBook('${book.id}')">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="delete-btn" onclick="deleteBook('${book.id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </div>
                </div>
            `).join('');
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù†Ø´Ø±
        function loadPublishStageBooks() {
            const books = JSON.parse(localStorage.getItem('books') || '[]');
            const publishStageBooks = books.filter(book => book.verified && !book.published);
            const publishStageList = document.getElementById('publishStageList');
            
            if (publishStageBooks.length === 0) {
                publishStageList.innerHTML = '<div class="no-books">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒØªØ¨ Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø´Ø±</div>';
                return;
            }
            
            publishStageList.innerHTML = publishStageBooks.map(book => `
                <div class="book-item">
                    <div class="book-info">
                        <div>
                            <span class="status-badge status-verified">Ù…Ø¯Ù‚Ù‚</span>
                            <span class="book-item-title">${book.title}</span>
                        </div>
                        <div class="book-item-author">âœï¸ ${book.author}</div>
                        <div class="book-item-date">ğŸ“… ØªØ¯Ù‚ÙŠÙ‚: ${book.verifiedDate || book.date} | ğŸ“„ ${book.pages ? book.pages.length : 0} ØµÙØ­Ø©</div>
                    </div>
                    <div class="book-actions">
                        <button class="edit-btn preview-btn" onclick="manageBook('${book.id}')">ğŸ“š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙØ­Ø§Øª</button>
                        <button class="verify-btn" onclick="publishBook('${book.id}')">ğŸš€ Ù†Ø´Ø± Ù„Ù„Ù‚Ø±Ø§Ø¡</button>
                        <button class="edit-btn" onclick="editBook('${book.id}')">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="delete-btn" onclick="deleteBook('${book.id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </div>
                </div>
            `).join('');
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©
        function loadPublishedBooks() {
            const books = JSON.parse(localStorage.getItem('books') || '[]');
            const publishedBooks = books.filter(book => book.published);
            const publishedList = document.getElementById('publishedList');
            
            if (publishedBooks.length === 0) {
                publishedList.innerHTML = '<div class="no-books">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒØªØ¨ Ù…Ù†Ø´ÙˆØ±Ø© Ø¨Ø¹Ø¯</div>';
                return;
            }
            
            publishedList.innerHTML = publishedBooks.map(book => `
                <div class="book-item">
                    <div class="book-info">
                        <div>
                            <span class="status-badge status-verified">Ù…Ù†Ø´ÙˆØ±</span>
                            <span class="book-item-title">${book.title}</span>
                        </div>
                        <div class="book-item-author">âœï¸ ${book.author}</div>
                        <div class="book-item-date">ğŸ“… Ù†Ø´Ø±: ${book.publishedDate || book.date} | ğŸ“„ ${book.pages ? book.pages.length : 0} ØµÙØ­Ø© | ğŸ‘ï¸ ${book.views || 0} Ù…Ø´Ø§Ù‡Ø¯Ø©</div>
                    </div>
                    <div class="book-actions">
                        <button class="edit-btn preview-btn" onclick="manageBook('${book.id}')">ğŸ“š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙØ­Ø§Øª</button>
                        <button class="edit-btn preview-btn" onclick="previewBook('${book.id}')">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
                        <button class="edit-btn" onclick="editBook('${book.id}')">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="delete-btn" onclick="unpublishBook('${book.id}')">â¸ï¸ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù†Ø´Ø±</button>
                    </div>
                </div>
            `).join('');
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function loadStats() {
            const books = JSON.parse(localStorage.getItem('books') || '[]');
            const publishedBooks = books.filter(book => book.published);
            const verifiedBooks = books.filter(book => book.verified && !book.published);
            const pendingBooks = books.filter(book => !book.verified && !book.published);
            const totalViews = books.reduce((sum, book) => sum + (book.views || 0), 0);
            
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${books.length}</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒØªØ¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${pendingBooks.length}</div>
                    <div class="stat-label">Ù‚ÙŠØ¯ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${verifiedBooks.length}</div>
                    <div class="stat-label">Ø¬Ø§Ù‡Ø² Ù„Ù„Ù†Ø´Ø±</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${publishedBooks.length}</div>
                    <div class="stat-label">Ù…Ù†Ø´ÙˆØ±</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${totalViews}</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª</div>
                </div>
            `;
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function loadAllTabs() {
            loadReviewBooks();
            loadPublishStageBooks();
            loadPublishedBooks();
            loadStats();
        }

        // ØªØ¹Ø¯ÙŠÙ„ ÙƒØªØ§Ø¨
        function editBook(id) {
            const books = JSON.parse(localStorage.getItem('books') || '[]');
            const book = books.find(b => b.id === id);
            
            if (book) {
                document.getElementById('titleInput').value = book.title;
                document.getElementById('authorInput').value = book.author;
                document.getElementById('descriptionInput').value = book.description;
                document.getElementById('editingId').value = book.id;
                
                document.getElementById('descCharCount').textContent = book.description.length + ' Ø­Ø±Ù';
                
                document.querySelector('.publish-btn').textContent = 'ğŸ’¾ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒØªØ§Ø¨';
                
                switchTab('publish');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„ÙƒØªØ§Ø¨
        function verifyBook(id) {
            if (confirm('âœ… Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ¯Ù‚ÙŠÙ‚ Ù‡Ø°Ø§ Ø§Ù„ÙƒØªØ§Ø¨ ÙˆÙ†Ù‚Ù„Ù‡ Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù†Ø´Ø±ØŸ')) {
                let books = JSON.parse(localStorage.getItem('books') || '[]');
                const index = books.findIndex(b => b.id === id);
                
                if (index !== -1) {
                    books[index].verified = true;
                    books[index].verifiedDate = new Date().toLocaleDateString('ar-EG');
                    localStorage.setItem('books', JSON.stringify(books));
                    loadAllTabs();
                    switchTab('publish-stage');
                    
                    alert('âœ… ØªÙ… ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„ÙƒØªØ§Ø¨! Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø¢Ù† ÙÙŠ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù†Ø´Ø±.');
                }
            }
        }

        // Ù†Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨ Ù„Ù„Ù‚Ø±Ø§Ø¡
        function publishBook(id) {
            if (confirm('ğŸš€ Ù‡Ù„ ØªØ±ÙŠØ¯ Ù†Ø´Ø± Ù‡Ø°Ø§ Ø§Ù„ÙƒØªØ§Ø¨ Ù„Ù„Ù‚Ø±Ø§Ø¡ØŸ')) {
                let books = JSON.parse(localStorage.getItem('books') || '[]');
                const index = books.findIndex(b => b.id === id);
                
                if (index !== -1) {
                    books[index].published = true;
                    books[index].publishedDate = new Date().toLocaleDateString('ar-EG');
                    localStorage.setItem('books', JSON.stringify(books));
                    loadAllTabs();
                    
                    alert('ğŸš€ ØªÙ… Ù†Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø¢Ù† Ù…ØªØ§Ø­ Ù„Ù„Ù‚Ø±Ø§Ø¡.');
                }
            }
        }

        // Ø¥Ù„ØºØ§Ø¡ Ù†Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨
        function unpublishBook(id) {
            if (confirm('â¸ï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù„ØºØ§Ø¡ Ù†Ø´Ø± Ù‡Ø°Ø§ Ø§Ù„ÙƒØªØ§Ø¨ØŸ')) {
                let books = JSON.parse(localStorage.getItem('books') || '[]');
                const index = books.findIndex(b => b.id === id);
                
                if (index !== -1) {
                    books[index].published = false;
                    localStorage.setItem('books', JSON.stringify(books));
                    loadAllTabs();
                    switchTab('publish-stage');
                    
                    alert('â¸ï¸ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ù†Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨. Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø¢Ù† ÙÙŠ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù†Ø´Ø±.');
                }
            }
        }

        // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØªØ§Ø¨ ÙˆØ§Ù„ØµÙØ­Ø§Øª
        function manageBook(id) {
            window.location.href = `manage-book.html?id=${id}`;
        }

        // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙƒØªØ§Ø¨
        function previewBook(id) {
            window.open(`read.html?id=${id}`, '_blank');
        }

        // Ø­Ø°Ù ÙƒØªØ§Ø¨
        function deleteBook(id) {
            if (confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ÙƒØªØ§Ø¨ØŸ')) {
                let books = JSON.parse(localStorage.getItem('books') || '[]');
                books = books.filter(b => b.id !== id);
                localStorage.setItem('books', JSON.stringify(books));
                loadAllTabs();
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªØ¨ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        loadAllTabs();
    </script>
</body>
</html>
